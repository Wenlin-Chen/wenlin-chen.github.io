[{"authors":null,"categories":null,"content":"I am a PhD student in Machine Learning at University of Cambridge (Machine Learning Group, Computational and Biological Learning Lab) and Max Planck Institute for Intelligent Systems (Department of Empirical Inference), under the Cambridge-Tübingen PhD Fellowship in Machine Learning. My supervisors are Professor José Miguel Hernández-Lobato, Professor Bernhard Schölkopf, and Dr Hong Ge.\nI am keen on basic research in machine learning and its scientific applications. My research interest lies at the intersection of probabilistic methods, deep learning, and causal inference. I aim to develop efficient machine learning methods for robust prediction and realistic data generation.\n","date":1696032000,"expirydate":-62135596800,"kind":"term","lang":"en","lastmod":1696032000,"objectID":"2525497d367e79493fd32b198b28f040","permalink":"","publishdate":"0001-01-01T00:00:00Z","relpermalink":"","section":"authors","summary":"I am a PhD student in Machine Learning at University of Cambridge (Machine Learning Group, Computational and Biological Learning Lab) and Max Planck Institute for Intelligent Systems (Department of Empirical Inference), under the Cambridge-Tübingen PhD Fellowship in Machine Learning.","tags":null,"title":"Wenlin Chen","type":"authors"},{"authors":null,"categories":null,"content":"These are my learning notes based on How to Train Your Energy-Based Models.\nGenerative Modeling Data: \\(x\\in\\mathcal{X}\\subseteq\\mathbb{R}^d\\), potentially high dimensional, complex, structured, e.g., high resolution images and videos, audio waveforms, 3D molecules, … Given: i.i.d. samples \\(\\{x_1,\\cdots,x_N\\}\\) from an unknown data distribution \\(p_D(x)\\). Goal: Draw new samples from \\(p_D(x)\\). Evaluate the probabilities of given samples under \\(p_D(x)\\). Approach: model \\(p_D(x)\\) with a parametric model \\(p_{\\theta}(x)\\) (e.g., parameterized by a neural network) and optimize \\(\\theta\\) such that \\(p_{\\theta}(x)\\approx p_D(x)\\). Energy-based Models Energy-based Models (EBMs) parameterize an energy function \\(E_{\\theta}(x)\\geq0\\) with parameters \\(\\theta\\): \\[p_{\\theta}(x)=\\frac{\\exp(-E_{\\theta}(x))}{Z_{\\theta}}.\\] the partition function/normalizing constant: \\[Z_{\\theta}=\\int \\exp(-E_{\\theta}(x)) dx,\\] analytically intractable, independent of the input \\(x\\) but dependent on the model parameters \\(\\theta\\). Maximum likelihood estimiation (MLE) with samples from the data distribution \\(p_D(x)\\): \\[\\max_{\\theta}~\\mathbb{E}_{p_D(x)}[\\log p_{\\theta}(x)] \\quad \\iff \\quad \\min_{\\theta} ~ \\text{KL}[p_D(x)||p_{\\theta}(x)].\\] MLE with gradient-based optimization: \\[\\nabla_{\\theta}\\log p_{\\theta}(x)=-\\nabla_{\\theta}E_{\\theta}(x)-\\nabla_{\\theta}\\log Z_{\\theta},\\] where the gradient of the log partition is intractable and hard to estimate: \\[ \\begin{aligned} \\nabla_{\\theta}\\log Z_{\\theta} \u0026amp;=\\frac{1}{Z_{\\theta}}\\nabla_{\\theta}\\int \\exp(-E_{\\theta}(x)) dx \\\\ \u0026amp;=\\frac{1}{Z_{\\theta}}\\int \\nabla_{\\theta} \\exp(-E_{\\theta}(x)) dx \\\\ \u0026amp;=\\int-\\nabla_{\\theta}E_{\\theta}(x)\\frac{\\exp(-E_{\\theta}(x))}{Z_{\\theta}}dx \\\\ \u0026amp;=-\\mathbb{E}_{p_{\\theta}(x)}[\\nabla_{\\theta}E_{\\theta}(x)]. \\end{aligned} \\] Score-based Models Score function: \\[s_{\\theta}(x)=\\nabla_x\\log p_{\\theta}(x)=-\\nabla_x E_{\\theta}(x),\\] independent of \\(Z_{\\theta}\\) thus tractable, not to be confused with \\(\\nabla_{\\theta}\\log p_{\\theta}(x)=-\\nabla_{\\theta}E_{\\theta}(x)-\\mathbb{E}_{p_{\\theta}(x)}[\\nabla_{\\theta}E_{\\theta}(x)]\\) which depends on \\(\\theta\\). Score-based models (SBMs) directly parameterize the score function \\(s_{\\theta}(x)\\in\\mathbb{R}^d\\). \\(s_{\\theta}(x)\\) may not be a conservative vector field (i.e., the gradient of something), but usually not a problem in practice. More efficient than EBM which needs to differentiate the energy to get the score. U-Net is a common model choice for image generation problems. Langevin Dynamics MCMC using score functions: \\[x^{(k+1)}=x^{(k)}+\\frac{\\epsilon^2}{2}\\nabla_x\\log p_{\\theta}(x)+\\epsilon z^{(k)},\\quad k=0,1,\\cdots,K,\\] or, equivalently, \\[x^{(k+1)}=x^{(k)}+\\epsilon\\nabla_x\\log p_{\\theta}(x)+\\sqrt{2\\epsilon} z^{(k)},\\quad k=0,1,\\cdots,K,\\] where \\(\\nabla_x\\log p_{\\theta}(x)=-\\nabla_x E_{\\theta}(x)\\) for EBMs and \\(\\nabla_x\\log p_{\\theta}(x)=s_{\\theta}(x)\\) for SBMs. \\(x^{(0)}\\) starts from some simple prior distribution (e.g., standard Gaussian), \\(z^{(k)}\\sim\\mathcal{N}(0,I)\\) are independent Gaussian noises, \\(x^{(k)}\\sim p_{\\theta}(x)\\) as \\(k\\to\\infty\\) and \\(\\epsilon\\to 0\\) under regularity conditions. If \\(p_{\\theta}(x)\\approx p_D(x)\\) after learning, then this allows us to draw samples from \\(p_D(x)\\). Score Matching Score matching (SM) by minimizing the Fisher divergence: \\[\\min_{\\theta}~D_F[p_D(x)||p_{\\theta}(x)]=\\mathbb{E}_{p_D(x)}\\left[\\frac{1}{2} \\Vert \\nabla_x \\log p_D(x) - s_{\\theta}(x)\\Vert^2\\right],\\] intractable due to the unknown the true data score \\(\\nabla_x \\log p_D(x)\\), (incompatible with manifold hypothesis) only works for full support \\(p_D(x)\\): if \\(\\mathcal{X}=\\mathbb{R}^d\\), then \\[s_{\\theta}(x)=\\nabla_x \\log p_D(x),~\\forall x\\in\\mathbb{R}^d\\quad\\iff\\quad p_{\\theta}=p_{D}.\\] A tractable score matching objective: \\[D_F[p_D(x)||p_{\\theta}(x)]=\\mathbb{E}_{p_D(x)}\\left[\\frac{1}{2}\\Vert s_{\\theta}(x)\\Vert^2 + \\text{Tr}(J_x s_{\\theta}(x))\\right]+\\text{const.}\\] Derived by integration by parts under regularity conditions. No unknown true data score term. The trace of the Jacobian of the score function \\(\\text{Tr}(J_x s_{\\theta}(x))\\) takes \\(\\mathcal{O}(d^2)\\) time to compute, which is still computationally expensive. Denoising Score Matching (DSM) Perturbe \\(p_D(x)\\) with a small noise: \\[\\tilde{x}=x+\\sigma z,\\quad z\\sim\\mathcal{N}(0,I),\\] or, equivalently, \\[p_{\\sigma}(\\tilde{x})=\\int q_{\\sigma}(\\tilde{x}|x)p_D(x)dx,\\quad\\text{where } q_{\\sigma}(\\tilde{x}|x)=\\mathcal{N}(\\tilde{x}|x,\\sigma^2I).\\] Match the score of the perturbed data distribution \\(p_{\\sigma}(\\tilde{x})\\): \\[ \\begin{aligned} \\min_{\\theta}~D_F[p_{\\sigma}(\\tilde{x})||p_{\\theta}(\\tilde{x})] \u0026amp;= \\mathbb{E}_{p_{\\sigma}(\\tilde{x})}\\left[\\frac{1}{2} \\Vert \\nabla_{\\tilde{x}} \\log p_{\\sigma}(\\tilde{x}) - s_{\\theta}(\\tilde{x})\\Vert^2\\right] \\\\\\\\ \u0026amp;= \\mathbb{E}_{q_{\\sigma}(\\tilde{x}|x)p_D(x)}\\left[\\frac{1}{2} \\Vert \\nabla_{\\tilde{x}} \\log q_{\\sigma}(\\tilde{x}|x) - s_{\\theta}(\\tilde{x})\\Vert^2\\right] + \\text{const} \\\\\\\\ \u0026amp;=\\mathbb{E}_{\\mathcal{N}(z|0,I)p_D(x)}\\left[\\frac{1}{2} \\left\\Vert \\frac{z}{\\sigma} + s_{\\theta}(x+\\sigma z)\\right\\Vert^2\\right] + \\text{const}. \\end{aligned} \\] No unknown true data score term. \\(p_{\\sigma}(\\tilde{x})\\) always has full support regardless of the support of \\(p_D(x)\\), since it is obtained by convolving \\(p_D(x)\\) with (full support) Gaussian noise \\(\\mathcal{N}(0,\\sigma^2I)\\). \\(\\sigma\\) needs to be close to zero, so that \\[s_{\\theta}(\\tilde{x})=\\nabla_{\\tilde{x}} \\log p_{\\sigma}(\\tilde{x}),~\\forall \\tilde{x}\\in\\mathbb{R}^d\\quad\\iff\\quad p_{\\theta}=p_{\\sigma}\\approx p_D.\\] \\(\\sigma\\) cannot be too small for the purpose of numerical stability (e.g., the DSM objective has a term \\(z/\\sigma\\)). Issues of DSM: \\(s_{\\theta}(x)\\) is inaccurate in low density regions of \\(p_D(x)\\) since very few or no samples are available for the model to train on. When drawing new samples via Langevin dynamics, the initial point \\(x^{(0)}\\) is very likely to be in a low density region in \\(\\mathbb{R}^d\\) if \\(d\\) is large. This prevents us from moving to high density regions, i.e., generating high quality samples that are representative of \\(p_D(x)\\). Need to use large \\(\\sigma\\) to populate low density regions, but there is a trade-off: \\(\\sigma\\) should be sufficiently large so that \\(p_{\\sigma}(\\tilde{x})\\) covers low density regions. Remember that \\(\\sigma\\) should also be sufficiently small so that \\(p_{\\sigma}\\approx p_D\\). Hard to balance the trade-off in practice… ","date":1702166400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1702166400,"objectID":"37b74d4cbf540a64d807ad4d6ed0fba4","permalink":"https://wenlin-chen.github.io/post/energy-score/","publishdate":"2023-12-10T00:00:00Z","relpermalink":"/post/energy-score/","section":"post","summary":"These are my learning notes based on How to Train Your Energy-Based Models.\nGenerative Modeling Data: \\(x\\in\\mathcal{X}\\subseteq\\mathbb{R}^d\\), potentially high dimensional, complex, structured, e.g., high resolution images and videos, audio waveforms, 3D molecules, … Given: i.","tags":null,"title":"Energy-based Models and Score Matching","type":"post"},{"authors":null,"categories":null,"content":"These are my learning notes based on Classical Mechanics and Classical Dynamics.\nNewtonian Mechanics Point particle: Mass: \\(m\u0026gt;0\\). Time: \\(t\\in\\mathbb{R}\\). Position: \\(\\mathbf{r}(t)\\in\\mathbb{R}^3\\). Velocity: \\(\\mathbf{v}(t)=\\mathbf{\\dot{r}}(t)\\). Accelartion: \\(\\mathbf{a}(t)=\\mathbf{\\dot{v}}(t)=\\mathbf{\\ddot{r}}(t)\\). Momentum: \\(\\mathbf{p}(t)=m\\mathbf{v}(t)=m\\mathbf{\\dot{r}}(t)\\). State: \\((\\mathbf{r},\\mathbf{p})\\in\\mathbb{R}^6\\). Newton’s first law: \\[\\mathbf{F}=\\mathbf{0}\\quad\\implies\\quad\\mathbf{r}(t)=\\mathbf{r}_0+\\mathbf{v}t.\\] Inertial frame: a frame in which a free particle move as stated by Newton’s first law. Newton’s second law: \\[\\mathbf{F}(\\mathbf{r},\\mathbf{\\dot{r}})=\\mathbf{\\dot{p}}.\\] Initial conditions: \\(\\mathbf{r}(t_0)\\) and \\(\\mathbf{p}(t_0)\\). Only holds in an inertial frame. Conservation law: \\(\\mathbf{F}=\\mathbf{0}~\\implies ~\\mathbf{p}=\\text{const}\\). Angular momentum: \\(\\mathbf{L}=\\mathbf{r}\\times\\mathbf{p}\\). torque: \\(\\boldsymbol{\\tau}=\\mathbf{r}\\times\\mathbf{F}\\). Newton’s second law holds for angular momentum: \\(\\boldsymbol{\\tau}=\\mathbf{\\dot{L}}\\). Conservation law: \\(\\boldsymbol{\\tau}=\\mathbf{0}~\\implies ~\\mathbf{L}=\\text{const}\\). Energy = kinetic energy + potential energy: \\[E=T(\\mathbf{\\dot{r}})+V(\\mathbf{r}).\\] Kinetic energy \\[T(\\mathbf{\\dot{r}})=\\frac{1}{2}m\\mathbf{\\dot{r}}^2.\\] Work done by the force: \\[T(\\mathbf{\\dot{r}}(t_2))-T(\\mathbf{\\dot{r}}(t_1))=\\int_{t_1}^{t_2}\\frac{dT}{dt}dt=\\int_{t_1}^{t_2}\\mathbf{F}\\cdot\\mathbf{\\dot{r}}dt=\\int_{t_1}^{t_2}\\mathbf{F}\\cdot d\\mathbf{r}.\\] Potential energy: \\[\\mathbf{F}=-\\nabla V(\\mathbf{r}).\\] Conservative force: \\[\\int_{t_1}^{t_2}\\mathbf{F}\\cdot d\\mathbf{r}=\\int_{t_1}^{t_2}-\\nabla V(\\mathbf{r})\\cdot d\\mathbf{r}=V(\\mathbf{r}(t_1))-V(\\mathbf{r}(t_2)).\\] Work done by the force is independent of the path: \\[\\oint \\mathbf{F}\\cdot d\\mathbf{r}=0\\quad\\iff\\quad \\nabla\\times\\mathbf{F}=\\mathbf{0}.\\] Conservation of energy: Proof 1: \\[T(\\mathbf{\\dot{r}}(t_2))-T(\\mathbf{\\dot{r}}(t_1))=\\int_{t_1}^{t_2}\\mathbf{F}\\cdot d\\mathbf{r}=V(\\mathbf{r}(t_1))-V(\\mathbf{r}(t_2))\\] \\[\\implies T(\\mathbf{\\dot{r}}(t_1))+V(\\mathbf{r}(t_1))=T(\\mathbf{\\dot{r}}(t_2))+V(\\mathbf{r}(t_2))\\equiv E.\\] Proof 2: \\[\\frac{dE}{dt}=\\mathbf{F}\\cdot\\mathbf{\\dot{r}}+\\nabla V(\\mathbf{r})\\cdot\\mathbf{\\dot{r}}=0.\\] System of \\(N\\) particles: Newton’s second law for each particle: \\[\\mathbf{F}_i=\\mathbf{\\dot{p}}_i.\\] External force: \\[\\mathbf{F}^{\\text{ext}}=\\sum_i\\mathbf{F}_i^{\\text{ext}}.\\] Decomposition of the force on each particle: \\[\\mathbf{F}_i=\\sum_{j\\not=i}\\mathbf{F}_{ij}+\\mathbf{F}_i^{\\text{ext}}.\\] Total mass: \\[M=\\sum_i m_i.\\] Center of mass: \\[\\mathbf{R}=\\frac{\\sum_i m_i\\mathbf{r}_i}{M}.\\] Total momentum: \\[\\mathbf{P}=\\sum_i\\mathbf{p}_i.\\] Phase space: \\((\\mathbf{r}_1,\\cdots,\\mathbf{r}_N,\\mathbf{p}_1,\\cdots,\\mathbf{p}_N)\\in\\mathbb{R}^{6N}\\). Newton’s third law: \\[\\mathbf{F}_{ij}=-\\mathbf{F}_{ji},\\quad\\text{which are parallel to $(\\mathbf{r}_i-\\mathbf{r}_j)$}.\\] Total force equals external force: \\[\\sum_i\\mathbf{F}_i=\\sum_i\\sum_{j\\not=i}\\mathbf{F}_{ij}+\\sum_i\\mathbf{F}_i^{\\text{ext}}=\\sum_i\\sum_{j\u0026gt;i}(\\mathbf{F}_{ij}+\\mathbf{F}_{ji})+\\sum_i\\mathbf{F}_i^{\\text{ext}}=\\sum_i\\mathbf{F}_i^{\\text{ext}}=\\mathbf{F}^{\\text{ext}}.\\] Newton’s second law for the whole system: \\[\\mathbf{F}^{\\text{ext}}=M\\mathbf{\\ddot{R}}.\\] Conservation of total momentum for an isolated system of particles (\\(\\mathbf{F}^{\\text{ext}}=\\mathbf{0}\\)): \\[\\frac{d\\mathbf{P}}{dt}=\\sum_i\\frac{d\\mathbf{p}_i}{dt}=\\sum_i\\mathbf{F}_i=\\mathbf{0}.\\] Total energy Total kinetic energy: \\[T=\\sum_i T_i=\\frac{1}{2}\\sum_i m_i\\mathbf{\\dot{r}}_i^2.\\] Change in total kinetic energy: \\[\\sum_i\\int_{t_1}^{t_2}\\mathbf{F}_i\\cdot d\\mathbf{r}_i=\\sum_i \\int_{t_1}^{t_2}\\mathbf{F}_i^{\\text{ext}}\\cdot d\\mathbf{r}_i+\\sum_i\\sum_{j\\not=i}\\int_{t_1}^{t_2}\\mathbf{F}_{ij}d\\mathbf{r}_i.\\] Conservative external forces: \\[\\mathbf{F}_i^{\\text{ext}}=-\\nabla_i V_i(\\mathbf{r}_i).\\] Conservative internal forces by Newton’s third law: \\[\\mathbf{F}_{ij}=-\\nabla_i V_{ij}(|\\mathbf{r}_i-\\mathbf{r}_j|)\\quad\\text{and}\\quad V_{ij}=V_{ji}.\\] Total potential energy: \\[V=\\sum_i V_i + \\sum_i\\sum_{j\u0026gt;i}V_{ij}.\\] The total energy \\(H=T+V\\) is conserved. Lagrangian Mechanics Calculus of variations Example: length \\(s[x(t)]\\) of a path \\(x(t)\\) between two points \\((t_1,x(t_1))\\) and \\((t_2,x(t_2))\\) \\[ds=\\sqrt{dt^2+dx^2}=\\sqrt{1+\\left(\\frac{dx}{dt}\\right)^2}dt,\\] \\[s[x(t)]=\\int_{t_1}^{t_2}\\sqrt{1+\\left(\\frac{dx}{dt}\\right)^2}dt.\\] Goal: find the shortest parth, i.e., find a function \\(x(t)\\) that minimizes the functional \\(s[x(t)]\\). Approach: set \\(\\delta s[x(t)]=0\\), meaning that \\(\\delta s=0\\) under any slight change of the path \\(x(t)\\) by \\(\\delta x(t)\\). Systems of \\(N\\) particles Positions: \\(\\mathbf{x}(t)=(x_1(t),\\cdots,x_{3N}(t))\\in\\mathbb{R}^{3N}\\). \\(3N\\)-dimensional configuration space \\(C\\). Degrees of freedom: \\(3N\\). Each point in \\(C\\) is a configuration of the system. Time evolution results in a path in \\(C\\). Principle of least action Really be principle of “stationary action”. Consider all smooth path \\(\\mathbf{x}(t)\\) in \\(C\\) with fixed end points \\(\\mathbf{x}(t_1)\\) and \\(\\mathbf{x}(t_2)\\). Action \\(A\\): a number assigned to each path \\[A[\\mathbf{x}(t)]=\\int_{t_1}^{t_2}L(\\mathbf{x}(t),\\mathbf{\\dot{x}}(t))dt\\] \\(A\\) is a functional of \\(\\mathbf{x}(t)\\). \\(L\\) is the Lagrangian defined as \\[L(\\mathbf{x},\\mathbf{\\dot{x}})=T(\\mathbf{\\dot{x}})-V(\\mathbf{x}).\\] Theorem: the actual path taken by the system makes \\(A\\) stationary. Proof: Slightly change a given path \\(\\mathbf{x}(t)\\) by \\(\\delta\\mathbf{x}(t)\\) which has fixed end points \\(\\delta\\mathbf{x}(t_1)=\\delta\\mathbf{x}(t_2)=\\mathbf{0}\\). Setting \\[ \\begin{aligned} \\delta A \u0026amp;= \\delta\\int_{t_1}^{t_2}L~dt \\\\\\\\ \u0026amp;= \\int_{t_1}^{t_2}\\delta L~dt \\\\\\\\ \u0026amp;= \\int_{t_1}^{t_2}\\sum_i\\left(\\frac{\\partial L}{\\partial x_i}\\delta x_i+\\frac{\\partial L}{\\partial \\dot{x}_i}\\delta \\dot{x}_i\\right)dt \\\\\\\\ \u0026amp;= \\sum_i \\left(\\int_{t_1}^{t_2}\\frac{\\partial L}{\\partial x_i}\\delta x_i dt+\\left[\\frac{\\partial L}{\\partial \\dot{x}_i}\\delta x_i\\right]_{t_1}^{t_2}-\\int_{t_1}^{t_2}\\left(\\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{x}_i}\\right)\\right)\\delta x_i dt\\right) \\\\\\\\ \u0026amp;= \\sum_i \\int_{t_1}^{t_2}\\left(\\frac{\\partial L}{\\partial x_i}-\\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{x}_i}\\right)\\right)\\delta x_i dt = 0, \\quad\\text{for all changes $\\delta\\mathbf{x}(t)$,} \\end{aligned} \\] gives Lagrangian’s equations: \\[ \\frac{\\partial L}{\\partial x_i}-\\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{x}_i}\\right)=0,\\quad i=1,\\cdots,3N.\\] Lagrangian as a generator of equations of motion: \\[\\frac{\\partial L}{\\partial x_i}=-\\frac{\\partial V}{\\partial x_i}=F_i,\\] \\[\\frac{\\partial L}{\\partial \\dot{x}_i}=m\\dot{x}_i=p_i,\\] \\[\\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{x}_i}\\right)=\\dot{p}_i=F_i,\\] \\[\\implies \\frac{\\partial L}{\\partial x_i}-\\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{x}_i}\\right)=0.\\] Generalized coordinate systems Lagrangian’s equations hold in any coordinate systems. Consider an invertible coordinate transformation: \\[q_a=f_a(x_1,\\cdots,x_{3N},t),\\quad a=1,\\cdots,3N.\\] Solving the inverse transformation \\[x_i=g_i(x_1,\\cdots,x_{3N},t),\\quad i=1,\\cdots,3N\\] and pluging them into the Lagrangian’s equations gives the equations of motion in the new coordinate system, which is much eaiser than directly dealing with the equations of motions. Important quantities from the Lagrangian: TBD Symmetries and conservation laws TBD Hamiltonian Mechanics TBD\nPoisson Brackets TBD\nElectric and Magnetic Fields TBD\n","date":1701388800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1701388800,"objectID":"c71bb37e6902a3ff6e8ae183ac2404b2","permalink":"https://wenlin-chen.github.io/post/classical-mechanics/","publishdate":"2023-12-01T00:00:00Z","relpermalink":"/post/classical-mechanics/","section":"post","summary":"These are my learning notes based on Classical Mechanics and Classical Dynamics.\nNewtonian Mechanics Point particle: Mass: \\(m\u0026gt;0\\). Time: \\(t\\in\\mathbb{R}\\). Position: \\(\\mathbf{r}(t)\\in\\mathbb{R}^3\\). Velocity: \\(\\mathbf{v}(t)=\\mathbf{\\dot{r}}(t)\\). Accelartion: \\(\\mathbf{a}(t)=\\mathbf{\\dot{v}}(t)=\\mathbf{\\ddot{r}}(t)\\). Momentum: \\(\\mathbf{p}(t)=m\\mathbf{v}(t)=m\\mathbf{\\dot{r}}(t)\\). State: \\((\\mathbf{r},\\mathbf{p})\\in\\mathbb{R}^6\\). Newton’s first law: \\[\\mathbf{F}=\\mathbf{0}\\quad\\implies\\quad\\mathbf{r}(t)=\\mathbf{r}_0+\\mathbf{v}t.","tags":null,"title":"Classical Mechanics","type":"post"},{"authors":["Wen Wu","Wenlin Chen","Chao Zhang","Philip C. Woodland"],"categories":null,"content":"\n","date":1696032000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1696032000,"objectID":"a813e18c87043788c6c22b08f0d565dd","permalink":"https://wenlin-chen.github.io/publication/wu2023has/","publishdate":"2023-09-30T00:00:00Z","relpermalink":"/publication/wu2023has/","section":"publication","summary":"Human annotator simulation (HAS) serves as a cost-effective substitute for human evaluation such as data annotation and system assessment. Human perception and behaviour during human evaluation exhibit inherent variability due to diverse cognitive processes and subjective interpretations, which should be taken into account in modelling to better mimic the way people perceive and interact with the world. This paper introduces a novel meta-learning framework that treats HAS as a zero-shot density estimation problem, which incorporates human variability and allows for the efficient generation of human-like annotations for unlabelled test inputs. Under this framework, we propose two new model classes, conditional integer flows and conditional softmax flows, to account for ordinal and categorical annotations, respectively. The proposed method is evaluated on three real-world human evaluation tasks and shows superior capability and efficiency to predict the aggregated behaviours of human annotators, match the distribution of human annotations, and simulate the inter-annotator disagreements.","tags":[],"title":"It HAS to be Subjective: Human Annotator Simulation via Zero-shot Density Estimation","type":"publication"},{"authors":["Wenlin Chen","Julien Horwood","Juyeon Heo","José Miguel Hernández-Lobato"],"categories":null,"content":"\n","date":1687824000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1687824000,"objectID":"6039f5f4bbc26f58c353b25a8afbb2f9","permalink":"https://wenlin-chen.github.io/publication/chen2023leveraging/","publishdate":"2023-06-27T00:00:00Z","relpermalink":"/publication/chen2023leveraging/","section":"publication","summary":"This work extends the theory of identifiability in supervised learning by considering the consequences of having access to a distribution of tasks. In such cases, we show that identifiability is achievable even in the case of regression, extending prior work restricted to the single-task classification case. Furthermore, we show that the existence of a task distribution which defines a conditional prior over latent variables reduces the equivalence class for identifiability to permutations and scaling, a much stronger and more useful result. When we further assume a causal structure over these tasks, our approach enables simple maximum marginal likelihood optimization together with downstream applicability to causal representation learning. Empirically, we validate that our model outperforms more general unsupervised models in recovering canonical representations for synthetic and real-world data.","tags":[],"title":"Leveraging Task Structures for Improved Identifiability in Neural Network Representations","type":"publication"},{"authors":["Wenlin Chen","Hong Ge"],"categories":null,"content":"\n","date":1684972800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1684972800,"objectID":"724a54e99e1fb3b3b87a33cffd45322e","permalink":"https://wenlin-chen.github.io/publication/chen2023neural/","publishdate":"2023-05-25T00:00:00Z","relpermalink":"/publication/chen2023neural/","section":"publication","summary":"We examine the characteristic activation values of individual ReLU units in neural networks. We refer to the corresponding set for such characteristic activation values in the input space as the characteristic activation set of a ReLU unit. We draw an explicit connection between the characteristic activation set and learned features in ReLU networks. This connection leads to new insights into why various neural network normalization techniques used in modern deep learning architectures regularize and stabilize SGD optimization. Utilizing these insights, we propose a geometric approach to parameterize ReLU networks for improved feature learning. We empirically verify its usefulness with less carefully chosen initialization schemes and larger learning rates. We report improved optimization stability, faster convergence speed, and better generalization performance.","tags":[],"title":"Neural Characteristic Activation Value Analysis for Improved ReLU Network Feature Learning","type":"publication"},{"authors":["Wenlin Chen","Austin Tripp","José Miguel Hernández-Lobato"],"categories":null,"content":"\n","date":1682899200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1682899200,"objectID":"e7e2dce54685980967029d324635a717","permalink":"https://wenlin-chen.github.io/publication/chen2023meta/","publishdate":"2022-05-05T00:00:00Z","relpermalink":"/publication/chen2023meta/","section":"publication","summary":"We propose Adaptive Deep Kernel Fitting with Implicit Function Theorem (ADKF-IFT), a novel framework for learning deep kernel Gaussian processes (GPs) by interpolating between meta-learning and conventional deep kernel learning. Our approach employs a bilevel optimization objective where we meta-learn generally useful feature representations across tasks, in the sense that task-specific GP models estimated on top of such features achieve the lowest possible predictive loss on average. We solve the resulting nested optimization problem using the implicit function theorem (IFT). We show that our ADKF-IFT framework contains previously proposed Deep Kernel Learning (DKL) and Deep Kernel Transfer (DKT) as special cases. Although ADKF-IFT is a completely general method, we argue that it is especially well-suited for drug discovery problems and demonstrate that it significantly outperforms previous state-of-the-art methods on a variety of real-world few-shot molecular property prediction tasks and out-of-domain molecular property prediction and optimization tasks.","tags":[],"title":"Meta-learning Adaptive Deep Kernel Gaussian Processes for Molecular Property Prediction","type":"publication"},{"authors":["Wenlin Chen","Samuel Horváth","Peter Richtárik"],"categories":null,"content":"\n","date":1661126400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1661126400,"objectID":"eee04c746fd5fbd08cbed0a0667cb0ed","permalink":"https://wenlin-chen.github.io/publication/chen2022optimal/","publishdate":"2022-08-04T00:00:00Z","relpermalink":"/publication/chen2022optimal/","section":"publication","summary":"It is well understood that client-master communication can be a primary bottleneck in federated learning (FL). In this work, we address this issue with a novel client subsampling scheme, where we restrict the number of clients allowed to communicate their updates back to the master node. In each communication round, all participating clients compute their updates, but only the ones with \"important\" updates communicate back to the master. We show that importance can be measured using only the norm of the update and give a formula for optimal client participation. This formula minimizes the distance between the full update, where all clients participate, and our limited update, where the number of participating clients is restricted. In addition, we provide a simple algorithm that approximates the optimal formula for client participation, which allows for secure aggregation and stateless clients, and thus does not compromise client privacy. We show both theoretically and empirically that for Distributed SGD (DSGD) and Federated Averaging (FedAvg), the performance of our approach can be close to full participation and superior to the baseline where participating clients are sampled uniformly. Moreover, our approach is orthogonal to and compatible with existing methods for reducing communication overhead, such as local methods and communication compression methods.","tags":[],"title":"Optimal Client Sampling for Federated Learning","type":"publication"},{"authors":["Austin Tripp","Wenlin Chen","José Miguel Hernández-Lobato"],"categories":null,"content":"\n","date":1651190400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1651190400,"objectID":"7c674ec1dda2935eabce28cc88b5af57","permalink":"https://wenlin-chen.github.io/publication/tripp2022evaluation/","publishdate":"2022-04-29T00:00:00Z","relpermalink":"/publication/tripp2022evaluation/","section":"publication","summary":"De novo drug design has recently received increasing attention from the machine learning community. It is important that the field is aware of the actual goals and challenges of drug design and the roles that de novo molecule design algorithms could play in accelerating the process, so that algorithms can be evaluated in a way that reflects how they would be applied in real drug design scenarios. In this paper, we propose a framework for critically assessing the merits of benchmarks, and argue that most of the existing de novo drug design benchmark functions are either highly unrealistic or depend upon a surrogate model whose performance is not well characterized. In order for the field to achieve its long-term goals, we recommend that poor benchmarks (especially logP and QED) be deprecated in favour of better benchmarks. We hope that our proposed framework can play a part in developing new de novo drug design benchmarks that are more realistic and ideally incorporate the intrinsic goals of drug design.","tags":[],"title":"An Evaluation Framework for the Objective Functions of De Novo Drug Design Benchmarks","type":"publication"},{"authors":["Wenlin Chen"],"categories":null,"content":"\n","date":1629331200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1629331200,"objectID":"12bedca3d469d735925baf247e9638c5","permalink":"https://wenlin-chen.github.io/publication/chen2021causal/","publishdate":"2021-08-19T00:00:00Z","relpermalink":"/publication/chen2021causal/","section":"publication","summary":"In this thesis, we study causal representation learning for latent space optimization, which allows for robust and efficient generation of novel synthetic data with maximal target value.  We assume that the observed data was generated by a few latent factors, some of which are causally related to the target and others of which are spuriously correlated with the target and confounded by an environment variable. Our proposed method consists of three steps, which exploits the structure of the causal graph that describes the assumed underlying data generating process. In the first step, we recover the true data representation (i.e., the latent factors from which the observed data originated). We obtain novel identifiability theory, showing that the true data representation can be recovered up to simple transformations by a generalized version of identifiable variational auto-encoders. In the second step, we identify the causal latent factors of the target, for which we propose a practical causal inference scheme that employs (conditional) independence tests and causal discovery algorithms. Our method does not require having access to the true environment variable, which overcomes a major limitation of existing causal representation learning approaches in the literature. In the final step, we query latent points that correspond to data points with high target values by intervening upon the causal latent factors using standard latent space optimization techniques. We empirically evaluate and thoroughly analyze our method on three different tasks, including a chemical design task. We show that our method can successfully recover the true data representation in the finite data regime and correctly identify the causal latent factors of the target, which results in state-of-the-art performance for black-box optimization.","tags":[],"title":"Causal Representation Learning for Latent Space Optimization","type":"publication"},{"authors":["Andrew Webb","Charles Reynolds","Wenlin Chen","Henry Reeve","Dan Iliescu","Mikel Luján","Gavin Brown"],"categories":null,"content":"\n","date":1600041600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1600041600,"objectID":"73540bab56f2b0d108a710976f7b0dcb","permalink":"https://wenlin-chen.github.io/publication/webb2020ensemble/","publishdate":"2020-09-14T00:00:00Z","relpermalink":"/publication/webb2020ensemble/","section":"publication","summary":"End-to-End training (E2E) is becoming more and more popular to train complex Deep Network architectures. An interesting question is whether this trend will continue—are there any clear failure cases for E2E training? We study this question in depth, for the specific case of E2E training an ensemble of networks. Our strategy is to blend the gradient smoothly in between two extremes: from independent training of the networks, up to to full E2E training. We find clear failure cases, where overparameterized models cannot be trained E2E. A surprising result is that the optimum can sometimes lie in between the two, neither an ensemble or an E2E system. The work also uncovers links to Dropout, and raises questions around the nature of ensemble diversity and multi-branch networks.","tags":[],"title":"To Ensemble or Not Ensemble: When Does End-to-End Training Fail?","type":"publication"},{"authors":null,"categories":null,"content":"\n","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":-62135596800,"objectID":"f26b5133c34eec1aa0a09390a36c2ade","permalink":"https://wenlin-chen.github.io/admin/config.yml","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/admin/config.yml","section":"","summary":"","tags":null,"title":"","type":"wowchemycms"}]